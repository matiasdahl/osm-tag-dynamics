#!/bin/bash

#
# Note: the below assumes that the extracted data is in
# the ~/temp-data/ directory
#
cd src
rm -rf ~/temp-data/web-data
mkdir -p ~/temp-data/web-data
Rscript create_images.R ~/temp-data/ ~/temp-data/web-data/
cd ..


# delete any exiting gh-pages branch
git branch -d gh-pages
git push origin --delete gh-pages

git checkout --orphan gh-pages

# remove extra files not needed by the website
git rm -r src --force
git rm -r docs --force
git rm -r osm-data --force
git rm -r scripts --force
git rm 'README.md' --force
echo Try "[matiasdahl.github.io/osm-tag-dynamics/](http://matiasdahl.github.io/osm-tag-dynamics/)" > README.md
git add README.md

cp ~/temp-data/web-data/am_data.txt .
git add am_data.txt

mkdir images
cp ~/temp-data/web-data/images/*.svg images
git add images/*.svg

git mv web-site/index.html .
git mv web-site/main.js .
git mv web-site/style.css .
git rm -r web-site --force

git commit -m "Update of gh-pages"
git push origin gh-pages
git checkout master
